[build]
builder = "nixpacks"
buildCommand = "npm install && npm run build"

[deploy]
# Option 1: Current approach (should work)
startCommand = "npx vite preview --host 0.0.0.0 --port ${PORT:-4173}"

# Option 2: Alternative if above doesn't work
# startCommand = "PORT=$PORT npx vite preview --host 0.0.0.0"

# Option 3: Hardcoded fallback if nothing else works
# startCommand = "npx vite preview --host 0.0.0.0 --port 8080"

restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/"
healthcheckTimeout = 30
replicas = 1

[variables]
NODE_ENV = "production"
# PORT = "8080"  # Uncomment if using Option 3