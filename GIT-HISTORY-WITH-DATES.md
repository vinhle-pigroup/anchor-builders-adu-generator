# Git History for Anchor Builders ADU Generator\n\n## Full Commit History with Dates\n\n```
1c25f9c | 2025-08-11 14:12 | fix: Railway deployment configuration with Express server and nixpacks
fc0fd14 | 2025-08-11 13:20 | fix: update package-lock.json with Express dependencies
3c1d8da | 2025-08-11 13:19 | WIP on chore/prod-readiness-AUG8-template: b4ab626 fix: update package-lock.json with Express dependencies
2b8aab8 | 2025-08-11 13:19 | index on chore/prod-readiness-AUG8-template: b4ab626 fix: update package-lock.json with Express dependencies
b4ab626 | 2025-08-11 13:19 | fix: update package-lock.json with Express dependencies
c88f14c | 2025-08-11 06:12 | docs: add deployment checklist and update environment examples
f8a25fc | 2025-08-11 06:00 | fix: remove health check from React app Railway config - only PDF service needs it
5914a90 | 2025-08-11 05:59 | fix(railway): resolve monorepo deployment failures
b4eae86 | 2025-08-11 03:54 | üö® CRITICAL CHECKPOINT: All bugs fixed, production-ready state
e98650e | 2025-08-10 23:04 | fix(template): fix milestone timeline vertical line to stop at M7 and center through circles
bf16ded | 2025-08-10 22:52 | fix(critical): ensure enhanced template parameter passed to PDF generator
c14b5d4 | 2025-08-10 22:48 | chore(build): production build verified and UX sanity checklist complete
c21b38d | 2025-08-10 22:47 | docs: production audit, deployment runbook, and env example
9a586e4 | 2025-08-10 22:46 | chore(audit): add sample PDFs and template screenshot
919e799 | 2025-08-10 22:44 | chore(ts): clean unused vars/imports and align types for pricing flow
6224896 | 2025-08-10 22:40 | fix(pdf): embed real Anchor Builders logo via base64 helper
6f78b85 | 2025-08-10 22:39 | feat(pdf): template resolver wiring ENHANCED-AUG8-CHECKPOINT with fallbacks
ebed879 | 2025-08-10 20:51 | üöÄ Complete Professional ADU Generator with Enhanced PDF Integration
08535f8 | 2025-08-09 18:01 | üé® DESIGN ITERATION: Enhanced 3D UI with sophisticated visual effects
7932aa0 | 2025-08-09 00:03 | feat: Complete internal layout redesign with navy blue accents + LA/OC catalog cleanup
28610c4 | 2025-08-08 23:05 | Checkpoint before layout redesign
ed2b283 | 2025-08-08 13:48 | üéØ MAJOR PRICING & MILESTONE FIXES: Complete calculation overhaul
a71ee67 | 2025-08-07 23:59 | feat: Add horizontal timeline + fix critical selectedAddOns sync bug
fb2a23f | 2025-08-05 15:00 | feat: add test data button for rapid PDF testing
f541fc2 | 2025-07-31 17:34 | feat: improve layout and pricing table formatting
247090e | 2025-07-31 17:32 | feat: redesign header layout for more compact design
cacf416 | 2025-07-31 17:30 | fix: update logo path to use root directory logo file
0cdfafa | 2025-07-31 16:40 | feat: standardize font sizes to 10px and move pricing table to page 2
d9f918d | 2025-07-31 13:37 | feat: add HVAC selection field and enhanced UI components
4db4789 | 2025-07-29 10:04 | feat: create new modern PDF design template with improved UX
c7add96 | 2025-07-29 10:03 | checkpoint: stable production deployment with team documentation
5c5a615 | 2025-07-28 13:55 | security: remove .env.backup from repository and add to gitignore
a6cfa67 | 2025-07-28 13:41 | feat: deploy enhanced Anchor ADU PDF generator with latest improvements
dfb6c21 | 2025-07-27 01:58 | fix: restore PDF template generator and form validation
d313a04 | 2025-07-26 23:22 | fix: add missing State field and implement comprehensive improvements
b304935 | 2025-07-26 02:00 | feat: implement fully functional View & Edit and Admin Settings
70edb95 | 2025-07-26 01:51 | feat(layout): condense sections to fit on one page
6f83be3 | 2025-07-26 01:45 | fix(timeline): move PROJECT TIMELINE section down 1-2 rows with margin-top
b885693 | 2025-07-26 01:35 | feat(pdf): reduce timeline phase image sizes for better A4 fit
648b6f3 | 2025-07-26 01:31 | feat(pdf): reorganize layout - cost breakdown to page 2, timeline to page 3
08ee78f | 2025-07-26 01:20 | feat(pdf): optimize A4 template spacing and layout
e66879f | 2025-07-26 01:15 | feat(pdf): optimize template for A4 paper format and eliminate print cutoff
faaff44 | 2025-07-26 00:49 | fix: improve PDF print layout to prevent content cutoff
306b02f | 2025-07-26 00:43 | trigger Railway deployment: force rebuild with latest changes
e496d14 | 2025-07-25 15:11 | feat: optimize PDF layout for 8.5x11 printing with compact client info
365a7b2 | 2025-07-25 15:07 | feat: add complete PDF template sections - inclusions, exclusions, testing requirements
4c49808 | 2025-07-25 14:51 | feat: replace PDF template with complete HTML design file
91be7d9 | 2025-07-25 14:43 | feat: expand PDF template with complete proposal content
ac59eb2 | 2025-07-25 14:40 | feat: move Generate Proposal button to top of form
4766bde | 2025-07-25 14:31 | revert: restore original technical form language
0ba792f | 2025-07-25 14:28 | revert: restore original phone field label from 'Best Phone Number *' to 'Phone *'
ef275cc | 2025-07-25 14:15 | feat(ux): improve form language and consolidate contact info
942aaaa | 2025-07-25 14:13 | fix(critical): resolve template literal interpretation errors
28ac8cf | 2025-07-25 14:08 | fix(pdf): resolve template literal ReferenceError causing fallback PDFs
df3d40e | 2025-07-25 14:02 | fix(pdf): remove HTML wrapping to preserve modern template design
c614e8e | 2025-07-25 13:58 | feat: deploy debug version with comprehensive console logging to troubleshoot blank PDF issue
18a6d71 | 2025-07-25 12:05 | fix(pdf): resolve blank PDF and download issues with embedded template
938fc66 | 2025-07-25 11:55 | chore: remove corrupted TypeScript config files
530c852 | 2025-07-25 11:49 | fix(pdf): implement browser print dialog instead of HTML file downloads
291c993 | 2025-07-25 11:30 | fix(pdf): resolve async/await issues in PDF generation
1be6964 | 2025-07-25 11:25 | feat: modernize ADU proposal system with Google Maps integration
695279a | 2025-07-24 11:16 | feat: improve form layout and functionality
7a39c48 | 2025-07-24 11:09 | feat: implement exact Excel ROUND formula for milestone calculations
3307d4a | 2025-07-24 10:50 | fix: display all 7 payment milestones correctly
045be20 | 2025-07-24 00:27 | fix: add base construction price per sqft to live pricing display
73572e7 | 2025-07-24 00:20 | trigger: force Railway deployment
54bcb2e | 2025-07-24 00:03 | feat: restore base construction price per sqft display
0929a1c | 2025-07-23 23:30 | feat: implement exact Excel milestone payment calculations
de119d9 | 2025-07-23 22:50 | feat: implement exact Anchor Builders pricing and template system
54843e8 | 2025-07-23 22:39 | fix: use exact official Anchor Builders logo provided by user
95bb8ba | 2025-07-23 22:36 | feat: update to official Anchor Builders JPEG logo
89a59fb | 2025-07-23 22:34 | feat: add official Anchor Builders logo to application
8961252 | 2025-07-23 16:24 | feat: implement single-page ADU proposal form with real-time pricing
3785f2e | 2025-07-22 23:05 | fix: resolve JSX syntax errors and improve form layout
bf32b4d | 2025-07-22 22:59 | fix: improve layout from cramped 3-column to proper 2-column design
2b1c625 | 2025-07-22 22:48 | feat: implement single-page form design
c14124c | 2025-07-20 23:47 | chore: optimize repository - remove temp files, unused deps, and add build optimizations
6d1f1bf | 2025-07-20 01:04 | feat: implement professional Excel-matching PDF template system
2353f0b | 2025-07-20 00:49 | fix: remove duplicate pricingEngine declaration causing build failure
650e474 | 2025-07-20 00:46 | fix: correct port assignment to 5000 per CLAUDE.md protocol
d16c70d | 2025-07-20 00:45 | fix: update Railway port to 8080 for deployment compatibility
532f412 | 2025-07-20 00:39 | feat: complete UI/UX improvements and milestone payment system
8283fae | 2025-07-20 00:16 | fix: correct design services pricing to $12,500 and add Anchor Builders logo
f314dcf | 2025-07-19 21:27 | feat: add sample PDF preview with mock data
8648972 | 2025-07-19 20:26 | feat: implement professional Anchor Builders design system
dc35cfe | 2025-07-19 16:33 | feat: add professional PDF generation with enhanced styling
c39580e | 2025-07-19 16:20 | feat: update project form to match Excel input fields
7bdd955 | 2025-07-19 10:12 | refactor: simplify pricing engine to match real Anchor Builders Excel model
152af08 | 2025-07-19 09:46 | fix: add Railway host to Vite allowed hosts for production deployment
657ba61 | 2025-07-19 08:57 | Initial commit: Anchor Builders ADU Proposal Generator
```\n\n## Detailed Important Commits\n\n```
ed2b283 | 2025-08-08 13:48 | Vinh Pham | üéØ MAJOR PRICING & MILESTONE FIXES: Complete calculation overhaul
    ## üö® Critical Issues Resolved
- ‚ùå Fixed negative Property Final milestone (-$1,200 ‚Üí positive amounts)
- ‚ùå Eliminated unwanted 15% contractor markup (0% markup enforced)
- ‚ùå Unified milestone calculations between input form and PDF
- ‚ùå Fixed Phase I pricing from incorrect percentage to fixed $12,500

## üîß Architecture Improvements
- ‚úÖ Single pricing engine used across input form and PDF generator
- ‚úÖ Milestone rounding: M1-M6 floor to clean thousands, M7 gets remainder
- ‚úÖ Input form and PDF now use same calculateMilestonePayments function
- ‚úÖ Forced markupPercentage: 0.0 in both calculations to prevent discrepancies

## üìã Timeline Design Enhancements
- ‚úÖ Extended timeline connector line with clean orange-to-blue gradient
- ‚úÖ Centered timeline elements within their own spaces
- ‚úÖ Logo and title sized up 10% for better visibility
- ‚úÖ Removed "Appliances Included" from scope of work section
- ‚úÖ Improved spacing and visual hierarchy

## üßÆ Milestone Calculation Logic (VERIFIED)
1. Construction Amount = Total - $12,500 (design) - $1,000 (deposit)
2. M1-M6: Floor to clean thousands (18%, 18%, 18%, 16%, 14%, 11%)
3. M7 Final: Gets remainder to ensure exact total match
4. Example: $175,000 construction ‚Üí M1-M6 clean amounts, M7 gets remainder

## üéØ Files Modified
- src/data/pricing-config.ts: Updated milestone calculation with clean rounding
- src/App.tsx: Added 0% markup override + unified milestone display
- src/lib/pdf-generator.ts: Forced 0% markup to match input form
- src/lib/pdf-template-generator.ts: Fixed Phase I to $12,500 fixed amount
- public/ENHANCED-DESIGN.html: Timeline improvements + header sizing
- TIMELINE-DESIGN-PARAMETERS.md: Comprehensive documentation added

## üöÄ Next Steps
- Use liveCalculation as single source of truth for PDF generation
- Eliminate remaining $500 discrepancy between input form and PDF
- Pass all totals and subtotals from input form to PDF generator

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

a71ee67 | 2025-08-07 23:59 | Vinh Pham | feat: Add horizontal timeline + fix critical selectedAddOns sync bug
    ## üéØ Major Features Added
- ‚úÖ Horizontal timeline section below Scope of Work in PDF template
- ‚úÖ Professional 2-phase timeline (Design & Construction) with visual connecting line
- ‚úÖ Responsive timeline design with proper proportional spacing

## üêõ Critical Bug Fixes
- ‚úÖ **MAJOR**: Fixed driveway/add-ons disappearing from PDF
- ‚úÖ Root cause: Test data hardcoded selectedAddOns:[] while populating pricingData
- ‚úÖ Solution: Dynamic selectedAddOns population based on actual addon costs

## üìÅ Files Modified
- `/public/ENHANCED-DESIGN.html` (Timeline CSS + HTML, lines 736-856, 1033-1056)
- `/src/App.tsx` (selectedAddOns sync fix, lines 201-205)
- `/CLAUDE.md` (Added context management protocol)

## üîç Technical Details
### Timeline Implementation:
- Design Phase: 21 days + 3-4 months city approval
- Construction Phase: 4-6 months after permit approval
- Total time: 8-12 months, color-coded amber/blue phases
- Z-index fix: line behind text, 60% width, proper centering

### Data Sync Bug Resolution:
**Before**: `selectedAddOns: []` (hardcoded empty array)
**After**: Dynamic array from pricing data:
```typescript
selectedAddOns: [
  ...(randomBathroom > 0 ? ['bathroom'] : []),
  ...(randomDriveway > 0 ? ['driveway'] : []),
  ...(randomLandscaping > 0 ? ['landscaping'] : []),
]
```

## üìä Impact
- ‚úÖ Add-on selections (driveway, bathroom, landscaping) now appear correctly in PDF
- ‚úÖ Timeline provides clear visual project expectations for clients
- ‚úÖ Resolved data synchronization gap between UI state and form submission
- ‚úÖ Established context management protocol for future sessions

## üîÆ Prevention Strategy
- Added systematic state validation reminder to CLAUDE.md
- Documented data sync patterns to prevent similar issues
- Created chat history preservation protocol for debugging reference

## üìã Documentation Added
- `CHAT-HISTORY-2025-08-08.md` - Session summary and technical analysis
- `CHAT-VERBATIM-2025-08-08.md` - Complete conversation archive
- `CLAUDE.md` - Context management protocol for 15% threshold

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

247090e | 2025-07-31 17:32 | Vinh Pham | feat: redesign header layout for more compact design
    - Reduced header section padding from 20px to 10px (50% reduction)
- Reduced ADU Construction Proposal font size from 30px to 18px
- Removed 'Comprehensive Design & Build Services' subtitle text
- Combined proposal date and proposal number into single side-by-side box layout
- Improved space efficiency while maintaining professional appearance

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

d9f918d | 2025-07-31 13:37 | Vinh Pham | feat: add HVAC selection field and enhanced UI components
    - Added HVAC system selection to project form (Central Air/Heat and Mini-Split System)
- Enhanced form validation with green indicators and error handling
- Added comprehensive component library (ErrorBoundary, LoadingSpinner, notifications)
- Updated PDF template with improved header design and pricing table
- Enhanced admin functionality with text editor and template management
- Improved pricing configuration and calculation engine

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

4db4789 | 2025-07-29 10:04 | Vinh Pham | feat: create new modern PDF design template with improved UX
    - New professional design with enhanced visual hierarchy
- Modern color palette and typography using Inter font
- Improved layout with better space utilization
- Enhanced client information display with stats cards
- Better organized pricing table with phase indicators
- Visual payment timeline with milestone tracking
- Professional signature section with clear terms
- Print-optimized styles for A4 paper
- Maintains all existing Handlebars variables
- Ready for web designer customization

Safe rollback point: main branch commit c7add96

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

c7add96 | 2025-07-29 10:03 | Vinh Pham | checkpoint: stable production deployment with team documentation
    - Production deployment working at railway.app
- Google Maps integration functional with regenerated API key
- PDF generation working correctly with complete template
- Team instructions and documentation ready
- All features verified and tested

This is a stable rollback point before new design changes.

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

a6cfa67 | 2025-07-28 13:41 | Vinh Pham | feat: deploy enhanced Anchor ADU PDF generator with latest improvements
    - Add comprehensive environment configuration
- Implement Google Maps integration service
- Enhance field formatting and validation
- Update PDF template generator with modern design
- Add design specifications documentation

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

08ee78f | 2025-07-26 01:20 | Vinh Pham | feat(pdf): optimize A4 template spacing and layout
    - Reduce padding throughout template for better A4 fit
- Header padding: 20px‚Üí15px, sections: 35px‚Üí28px
- Compress section divider margins: 12px‚Üí10px
- Optimize details section padding: 16px‚Üí14px
- Update print media queries for consistent A4 spacing
- Maintain professional layout with tighter content density

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

306b02f | 2025-07-26 00:43 | Vinh Pham | trigger Railway deployment: force rebuild with latest changes
    - Add latest UI improvements from monorepo
- Fix template generation and PDF styling
- Deploy enhanced Anchor ADU form design

365a7b2 | 2025-07-25 15:07 | Vinh Pham | feat: add complete PDF template sections - inclusions, exclusions, testing requirements
    - Add 'Project Details & Options' section with Items Not Included and Optional Enhancement Services
- Add 'Additional Scope Requirements' section with electrical and MEP testing details
- Include comprehensive exclusions list (gas/water connections, drainage, landscaping, etc.)
- Add optional upgrades with pricing (premium appliances, luxury fixtures, hardwood flooring)
- Add required testing verification for electrical, plumbing, and HVAC systems
- Enhanced terms & conditions with warranty and insurance information
- Template now matches complete design file 100%

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

4c49808 | 2025-07-25 14:51 | Vinh Pham | feat: replace PDF template with complete HTML design file
    - Replace simple template with professional multi-section design
- Add comprehensive styling with proper print optimization for 8.5x11
- Include all sections: header, project info, scope, pricing table, footer
- Add signature section with client acceptance
- Map all template variables to match HTML field names
- Add helper method for ADU type display formatting
- Optimize for letter-size printing with proper margins
- Professional layout matching sample PDF structure

Based on anchor-adu-proposal (1).html design file

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

0ba792f | 2025-07-25 14:28 | Vinh Pham | revert: restore original phone field label from 'Best Phone Number *' to 'Phone *'
    The previous change to 'Best Phone Number *' was unintended and meant for a different project.
Reverting to maintain consistency with existing form design.

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

28ac8cf | 2025-07-25 14:08 | Vinh Pham | fix(pdf): resolve template literal ReferenceError causing fallback PDFs
    Fixed critical issue where ${{GRAND_TOTAL}} and ${{COST_PER_SQFT}} were being
interpreted as JavaScript template literals instead of template placeholders.

Changes:
- Escaped ${{GRAND_TOTAL}} to \\${{GRAND_TOTAL}}
- Escaped ${{COST_PER_SQFT}} to \\${{COST_PER_SQFT}}
- Prevents ReferenceError: GRAND_TOTAL is not defined
- Ensures modern blue gradient template loads instead of fallback PDF

This should restore proper PDF generation with the intended template design.

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

df3d40e | 2025-07-25 14:02 | Vinh Pham | fix(pdf): remove HTML wrapping to preserve modern template design
    - Fixed htmlToPdfBlob method that was wrapping processed modern template HTML in additional basic HTML structure
- Modern template now displays correctly with blue gradient header and professional styling
- Added debug logging to track final HTML being used for PDF generation
- The processed HTML from getModernTemplate() already contains complete modern template with styling

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

18a6d71 | 2025-07-25 12:05 | Vinh Pham | fix(pdf): resolve blank PDF and download issues with embedded template
    - Replace template fetching with embedded modern template to fix blank PDFs
- Change from print dialog to direct HTML download + preview window
- Embedded template includes professional blue header styling and proper layout
- Users now get downloadable HTML file that opens correctly in browser
- Added "Save as PDF" workflow via browser print functionality
- Fixed template variable substitution for all client and project data
- Improved cross-browser compatibility and user experience

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

1be6964 | 2025-07-25 11:25 | Vinh Pham | feat: modernize ADU proposal system with Google Maps integration
    - Add modern PDF template with enhanced design
- Integrate Google Maps service for property satellite imagery
- Add environment configuration with graceful fallbacks
- Update pricing engine with accurate California rates
- Enhance PDF generator with template system
- Add comprehensive Google Maps setup documentation

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

045be20 | 2025-07-24 00:27 | Vinh Pham | fix: add base construction price per sqft to live pricing display
    - Show both base construction and total project price per sqft in web form
- Base Construction: shows the core construction rate (40-250/sqft)
- Total Project: shows final rate including design, add-ons, etc.
- Matches the PDF template display for consistency

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

54bcb2e | 2025-07-24 00:03 | Vinh Pham | feat: restore base construction price per sqft display
    - Add baseConstructionPricePerSqFt to pricing breakdown
- Display both base construction and total project cost per sqft
- Base Construction: 40-250/sqft (construction only)
- Total Project Cost: includes design, add-ons, utilities

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

0929a1c | 2025-07-23 23:30 | Vinh Pham | feat: implement exact Excel milestone payment calculations
    MILESTONE PAYMENT UPDATES:
- Add separate $1,000 deposit (max per CA law)
- Include design as separate line item
- 7 construction milestones: 20%, 20%, 20%, 15%, 15%, 10%, 5%
- Round payments to nearest $1,000 like Excel ROUND(amount, -3)
- Final milestone calculated as remainder for exact total
- Match Excel formula: (Total - Design - Deposit) * percentage

Based on actual Excel formulas from Anchor Builders proposals.

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

95bb8ba | 2025-07-23 22:36 | Vinh Pham | feat: update to official Anchor Builders JPEG logo
    - Replace SVG logo with high-quality JPEG version
- Use official brand assets for professional appearance
- Maintain responsive design and layout consistency

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>

```
